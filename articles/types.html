<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Correlation Types • correlation</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Correlation Types">
<meta property="og:description" content="correlation">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">correlation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/multilevel.html">Multilevel Correlations</a>
    </li>
    <li>
      <a href="../articles/types.html">Correlation Types</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/easystats/correlation/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="types_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Correlation Types</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/easystats/correlation/blob/master/vignettes/types.Rmd" class="external-link"><code>vignettes/types.Rmd</code></a></small>
      <div class="hidden name"><code>types.Rmd</code></div>

    </div>

    
    
<hr>
<p>This vignette can be cited as:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"correlation"</span><span class="op">)</span></code></pre></div>
<pre><code>&gt; 
&gt; To cite 'correlation' in publications use:
&gt; 
&gt;   Makowski, D., Ben-Shachar, M. S., Patil, I., &amp; Lüdecke, D. (2019).
&gt;   Methods and Algorithms for Correlation Analysis in R. Journal of Open
&gt;   Source Software, 5(51), 2306. doi:10.21105/joss.02306
&gt; 
&gt; A BibTeX entry for LaTeX users is
&gt; 
&gt;   @Article{,
&gt;     title = {Methods and Algorithms for Correlation Analysis in R.},
&gt;     author = {Dominique Makowski and Mattan S. Ben-Shachar and Indrajeet Patil and Daniel Lüdecke},
&gt;     doi = {10.21105/joss.02306},
&gt;     year = {2020},
&gt;     journal = {Journal of Open Source Software},
&gt;     number = {51},
&gt;     volume = {5},
&gt;     pages = {2306},
&gt;     url = {https://joss.theoj.org/papers/10.21105/joss.02306},
&gt;   }</code></pre>
<hr>
<div id="different-methods-for-correlations" class="section level2">
<h2 class="hasAnchor">
<a href="#different-methods-for-correlations" class="anchor" aria-hidden="true"></a>Different Methods for Correlations</h2>
<p>Correlations tests are arguably one of the most commonly used statistical procedures, and are used as a basis in many applications such as exploratory data analysis, structural modeling, data engineering, etc. In this context, we present <strong>correlation</strong>, a toolbox for the R language <span class="citation">(R Core Team 2019)</span> and part of the <a href="https://github.com/easystats/easystats" class="external-link"><strong>easystats</strong></a> collection, focused on correlation analysis. Its goal is to be lightweight, easy to use, and allows for the computation of many different kinds of correlations, such as:</p>
<ul>
<li>
<strong>Pearson’s correlation</strong>: This is the most common correlation method. It corresponds to the covariance of the two variables normalized (i.e., divided) by the product of their standard deviations.</li>
</ul>
<p><span class="math display">\[r_{xy} = \frac{cov(x,y)}{SD_x \times SD_y}\]</span></p>
<ul>
<li>
<strong>Spearman’s rank correlation</strong>: A non-parametric measure of correlation, the Spearman correlation between two variables is equal to the Pearson correlation between the rank scores of those two variables; while Pearson’s correlation assesses linear relationships, Spearman’s correlation assesses monotonic relationships (whether linear or not). Confidence Intervals (CI) for Spearman’s correlations are computed using the <span class="citation">Fieller, Hartley, and Pearson (1957)</span> correction <span class="citation">(see Bishara and Hittner 2017)</span>.</li>
</ul>
<p><span class="math display">\[r_{s_{xy}} = \frac{cov(rank_x, rank_y)}{SD(rank_x) \times SD(rank_y)}\]</span></p>
<ul>
<li>
<strong>Kendall’s rank correlation</strong>: In the normal case, the Kendall correlation is preferred to the Spearman correlation because of a smaller gross error sensitivity (GES) and a smaller asymptotic variance (AV), making it more robust and more efficient. However, the interpretation of Kendall’s tau is less direct compared to that of the Spearman’s rho, in the sense that it quantifies the difference between the % of concordant and discordant pairs among all possible pairwise events. Confidence Intervals (CI) for Kendall’s correlations are computed using the <span class="citation">Fieller, Hartley, and Pearson (1957)</span> correction <span class="citation">(see Bishara and Hittner 2017)</span>. For each pair of observations (i ,j) of two variables (x, y), it is defined as follows:</li>
</ul>
<p><span class="math display">\[\tau_{xy} = \frac{2}{n(n-1)}\sum_{i&lt;j}^{}sign(x_i - x_j) \times sign(y_i - y_j)\]</span></p>
<ul>
<li><p><strong>Biweight midcorrelation</strong>: A measure of similarity that is median-based, instead of the traditional mean-based, thus being less sensitive to outliers. It can be used as a robust alternative to other similarity metrics, such as Pearson correlation <span class="citation">(Langfelder and Horvath 2012)</span>.</p></li>
<li><p><strong>Distance correlation</strong>: Distance correlation measures both linear and non-linear association between two random variables or random vectors. This is in contrast to Pearson’s correlation, which can only detect linear association between two random variables.</p></li>
<li><p><strong>Percentage bend correlation</strong>: Introduced by Wilcox (1994), it is based on a down-weight of a specified percentage of marginal observations deviating from the median (by default, 20 percent).</p></li>
<li><p><strong>Shepherd’s Pi correlation</strong>: Equivalent to a Spearman’s rank correlation after outliers removal (by means of bootstrapped Mahalanobis distance).</p></li>
<li><p><strong>Blomqvist’s coefficient</strong>: The Blomqvist’s coefficient (also referred to as Blomqvist’s Beta or medial correlation; Blomqvist, 1950) is a median-based non-parametric correlation that has some advantages over measures such as Spearman’s or Kendall’s estimates (see Shmid and Schimdt, 2006).</p></li>
<li><p><strong>Hoeffding’s D</strong>: The Hoeffding’s D statistic is a non-parametric rank based measure of association that detects more general departures from independence (Hoeffding 1948), including non-linear associations. Hoeffding’s D varies between -0.5 and 1 (if there are no tied ranks, otherwise it can have lower values), with larger values indicating a stronger relationship between the variables.</p></li>
<li><p><strong>Gamma correlation</strong>: The Goodman-Kruskal gamma statistic is similar to Kendall’s Tau coefficient. It is relatively robust to outliers and deals well with data that have many ties.</p></li>
<li><p><strong>Gaussian rank correlation</strong>: The Gaussian rank correlation estimator is a simple and well-performing alternative for robust rank correlations (Boudt et al., 2012). It is based on the Gaussian quantiles of the ranks.</p></li>
<li><p><strong>Point-Biserial and biserial correlation</strong>: Correlation coefficient used when one variable is continuous and the other is dichotomous (binary). Point-Biserial is equivalent to a Pearson’s correlation, while Biserial should be used when the binary variable is assumed to have an underlying continuity. For example, anxiety level can be measured on a continuous scale, but can be classified dichotomously as high/low.</p></li>
<li><p><strong>Winsorized correlation</strong>: Correlation of variables that have been Winsorized, i.e., transformed by limiting extreme values to reduce the effect of possibly spurious outliers.</p></li>
<li><p><strong>Polychoric correlation</strong>: Correlation between two theorised normally distributed continuous latent variables, from two observed ordinal variables.</p></li>
<li><p><strong>Tetrachoric correlation</strong>: Special case of the polychoric correlation applicable when both observed variables are dichotomous.</p></li>
<li><p><strong>Partial correlation</strong>: Correlation between two variables after adjusting for the (linear) effect of one or more variables. The correlation test is run after having partialized the dataset, independently from it. In other words, it considers partialization as an independent step generating a different dataset, rather than belonging to the same model. This is why some discrepancies are to be expected for the <em>t</em>- and the <em>p</em>-values (but not the correlation coefficient) compared to other implementations such as <code>ppcor</code>. Let <span class="math inline">\(e_{x.z}\)</span> be the residuals from the linear prediction of <span class="math inline">\(x\)</span> by <span class="math inline">\(z\)</span> (note that this can be expanded to a multivariate <span class="math inline">\(z\)</span>):</p></li>
</ul>
<p><span class="math display">\[r_{xy.z} = r_{e_{x.z},e_{y.z}}\]</span></p>
<ul>
<li>
<strong>Multilevel correlation</strong>: Multilevel correlations are a special case of partial correlations where the variable to be adjusted for is a factor and is included as a random effect in a mixed-effects model.</li>
</ul>
</div>
<div id="comparison" class="section level2">
<h2 class="hasAnchor">
<a href="#comparison" class="anchor" aria-hidden="true"></a>Comparison</h2>
<p>We will fit different types of correlations of generated data with different link strengths and link types.</p>
<p>Let’s first load the required libraries for this analysis.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/correlation/" class="external-link">correlation</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/bayestestR/" class="external-link">bayestestR</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/see/" class="external-link">see</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></code></pre></div>
<div id="utility-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#utility-functions" class="anchor" aria-hidden="true"></a>Utility functions</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">generate_results</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">r</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">100</span>, <span class="va">transformation</span> <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">bayestestR</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/simulate_correlation.html" class="external-link">simulate_correlation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="va">transformation</span> <span class="op">!=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"("</span>, <span class="va">transformation</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">"data$V2)"</span>, <span class="st">"data$V2"</span><span class="op">)</span>
    <span class="va">transformation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">transformation</span>, <span class="va">var</span><span class="op">)</span>
    <span class="va">data</span><span class="op">$</span><span class="va">V2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="va">transformation</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, transformation <span class="op">=</span> <span class="va">transformation</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span>

  <span class="va">out</span><span class="op">$</span><span class="va">Pearson</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_test.html">cor_test</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"V1"</span>, <span class="st">"V2"</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span><span class="op">$</span><span class="va">r</span>
  <span class="va">out</span><span class="op">$</span><span class="va">Spearman</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_test.html">cor_test</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"V1"</span>, <span class="st">"V2"</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span><span class="op">$</span><span class="va">rho</span>
  <span class="va">out</span><span class="op">$</span><span class="va">Kendall</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_test.html">cor_test</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"V1"</span>, <span class="st">"V2"</span>, method <span class="op">=</span> <span class="st">"kendall"</span><span class="op">)</span><span class="op">$</span><span class="va">tau</span>
  <span class="va">out</span><span class="op">$</span><span class="va">Biweight</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_test.html">cor_test</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"V1"</span>, <span class="st">"V2"</span>, method <span class="op">=</span> <span class="st">"biweight"</span><span class="op">)</span><span class="op">$</span><span class="va">r</span>
  <span class="va">out</span><span class="op">$</span><span class="va">Distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_test.html">cor_test</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"V1"</span>, <span class="st">"V2"</span>, method <span class="op">=</span> <span class="st">"distance"</span><span class="op">)</span><span class="op">$</span><span class="va">r</span>
  <span class="va">out</span><span class="op">$</span><span class="va">Distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_test.html">cor_test</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"V1"</span>, <span class="st">"V2"</span>, method <span class="op">=</span> <span class="st">"distance"</span><span class="op">)</span><span class="op">$</span><span class="va">r</span>
  
  <span class="va">out</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="effect-of-relationship-type" class="section level3">
<h3 class="hasAnchor">
<a href="#effect-of-relationship-type" class="anchor" aria-hidden="true"></a>Effect of Relationship Type</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.999</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">transformation</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
      <span class="st">"none"</span>,
      <span class="st">"exp("</span>,
      <span class="st">"log10(1+max(abs(data$V2))+"</span>,
      <span class="st">"1/"</span>,
      <span class="st">"tan("</span>,
      <span class="st">"sin("</span>,
      <span class="st">"cos("</span>,
      <span class="st">"cos(2*"</span>,
      <span class="st">"abs("</span>,
      <span class="st">"data$V2*"</span>,
      <span class="st">"data$V2*data$V2*"</span>,
      <span class="st">"ifelse(data$V2&gt;0, 1, 0)*("</span>
    <span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu">generate_results</span><span class="op">(</span><span class="va">r</span>, <span class="va">n</span>, transformation <span class="op">=</span> <span class="va">transformation</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">}</span>
<span class="op">}</span>


<span class="va">data</span> <span class="op">%&gt;%</span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">r</span>, <span class="va">transformation</span><span class="op">)</span>,
                      names_to <span class="op">=</span> <span class="st">"Type"</span>,
                      values_to <span class="op">=</span> <span class="st">"Estimation"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Type <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html" class="external-link">fct_relevel</a></span><span class="op">(</span><span class="va">Type</span>, <span class="st">"Pearson"</span>, <span class="st">"Spearman"</span>, <span class="st">"Kendall"</span>, <span class="st">"Biweight"</span>, <span class="st">"Distance"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">r</span>, y <span class="op">=</span> <span class="va">Estimation</span>, fill <span class="op">=</span> <span class="va">Type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Type</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"loess"</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">see</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/see/reference/theme_modern.html" class="external-link">theme_modern</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://easystats.github.io/see/reference/scale_color_flat.html" class="external-link">scale_color_flat_d</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"rainbow"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://easystats.github.io/see/reference/scale_color_flat.html" class="external-link">scale_fill_flat_d</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"rainbow"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">transformation</span><span class="op">)</span></code></pre></div>
<p><img src="types_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">r</span>, <span class="va">transformation</span><span class="op">)</span>,
                      names_to <span class="op">=</span> <span class="st">"Type"</span>,
                      values_to <span class="op">=</span> <span class="st">"Estimation"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">r</span> <span class="op">~</span> <span class="va">Type</span> <span class="op">/</span> <span class="va">Estimation</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">parameters</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">parameters</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">model</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">Coefficient</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>&gt; Parameter                    | Coefficient |   SE |       95% CI | t(11903) |      p
&gt; ------------------------------------------------------------------------------------
&gt; Type [Distance] * Estimation |        0.90 | 0.02 | [0.86, 0.95] |    40.14 | &lt; .001
&gt; Type [Kendall] * Estimation  |        0.66 | 0.02 | [0.62, 0.70] |    32.07 | &lt; .001
&gt; Type [Biweight] * Estimation |        0.53 | 0.02 | [0.50, 0.57] |    29.24 | &lt; .001
&gt; Type [Spearman] * Estimation |        0.51 | 0.02 | [0.48, 0.54] |    31.70 | &lt; .001
&gt; Type [Pearson] * Estimation  |        0.44 | 0.02 | [0.41, 0.47] |    26.49 | &lt; .001</code></pre>
<p>As we can see, <strong>distance</strong> correlation is able to capture the strength even for severely non-linear relationships.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor" aria-hidden="true"></a>References</h1>
<div id="refs" class="references">
<div id="ref-bishara2017confidence">
<p>Bishara, Anthony J, and James B Hittner. 2017. “Confidence Intervals for Correlations When Data Are Not Normal.” <em>Behavior Research Methods</em> 49 (1): 294–309. <a href="https://doi.org/10.3758/s13428-016-0702-8" class="external-link">https://doi.org/10.3758/s13428-016-0702-8</a>.</p>
</div>
<div id="ref-fieller1957tests">
<p>Fieller, Edgar C, Herman O Hartley, and Egon S Pearson. 1957. “Tests for Rank Correlation Coefficients. I.” <em>Biometrika</em> 44 (3/4): 470–81. <a href="https://doi.org/10.1093/biomet/48.1-2.29" class="external-link">https://doi.org/10.1093/biomet/48.1-2.29</a>.</p>
</div>
<div id="ref-langfelder2012fast">
<p>Langfelder, Peter, and Steve Horvath. 2012. “Fast R Functions for Robust Correlations and Hierarchical Clustering.” <em>Journal of Statistical Software</em> 46 (11). <a href="https://www.jstatsoft.org/v46/i11/" class="external-link">https://www.jstatsoft.org/v46/i11/</a>.</p>
</div>
<div id="ref-Rteam">
<p>R Core Team. 2019. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/" class="external-link">https://www.R-project.org/</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://dominiquemakowski.github.io/" class="external-link external-link">Dominique Makowski</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link external-link">Indrajeet Patil</a>, <a href="https://github.com/strengejacke" class="external-link external-link">Daniel Lüdecke</a>, <a href="https://github.com/mattansb" class="external-link external-link">Mattan S. Ben-Shachar</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
