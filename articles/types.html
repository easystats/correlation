<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Correlation Types • correlation</title>
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Correlation Types">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">correlation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.7.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html" aria-label="Reference"><span class="fa fa-file-code"></span> Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html" aria-label="Articles"><span class="fa fa-book-reader"></span> Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html" aria-label="News"><span class="fa fa-newspaper"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-easystats" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="easystats"><span class="fa fab fa-r-project"></span> easystats</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-easystats">
<li><a class="external-link dropdown-item" href="https://easystats.github.io/bayestestR/">bayestestR</a></li>
    <li><a class="dropdown-item" href="https://easystats.github.io/correlation/">correlation</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/datawizard/">datawizard</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/easystats/">easystats</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/effectsize/">effectsize</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/insight/">insight</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/modelbased/">modelbased</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/performance/">performance</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/parameters/">parameters</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/report/">report</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/see/">see</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/easystats4u" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/easystats/correlation/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Correlation Types</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/easystats/correlation/blob/main/vignettes/types.Rmd" class="external-link"><code>vignettes/types.Rmd</code></a></small>
      <div class="d-none name"><code>types.Rmd</code></div>
    </div>

    
    
<hr>
<p>This vignette can be cited as:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"correlation"</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; To cite package 'correlation' in publications use:
&gt; 
&gt;   Makowski, D., Wiernik, B. M., Patil, I., Lüdecke, D., &amp; Ben-Shachar,
&gt;   M. S. (2022). correlation: Methods for correlation analysis (0.8.3)
&gt;   [R package]. https://CRAN.R-project.org/package=correlation (Original
&gt;   work published 2020)
&gt; 
&gt;   Makowski, D., Ben-Shachar, M. S., Patil, I., &amp; Lüdecke, D. (2019).
&gt;   Methods and algorithms for correlation analysis in R. Journal of Open
&gt;   Source Software, 5(51), 2306. https://doi.org/10.21105/joss.02306
&gt; 
&gt; To see these entries in BibTeX format, use 'print(&lt;citation&gt;,
&gt; bibtex=TRUE)', 'toBibtex(.)', or set
&gt; 'options(citation.bibtex.max=999)'.</code></pre>
<hr>
<div class="section level3">
<h3 id="different-methods-for-correlations">Different Methods for Correlations<a class="anchor" aria-label="anchor" href="#different-methods-for-correlations"></a>
</h3>
<p>Correlations tests are arguably one of the most commonly used
statistical procedures, and are used as a basis in many applications
such as exploratory data analysis, structural modeling, data
engineering, etc. In this context, we present
<strong>correlation</strong>, a toolbox for the R language <span class="citation">(R Core Team 2019)</span> and part of the <a href="https://github.com/easystats/easystats" class="external-link"><strong>easystats</strong></a>
collection, focused on correlation analysis. Its goal is to be
lightweight, easy to use, and allows for the computation of many
different kinds of correlations, such as:</p>
<ul>
<li>
<strong>Pearson’s correlation</strong>: This is the most common
correlation method. It corresponds to the covariance of the two
variables normalized (i.e., divided) by the product of their standard
deviations.</li>
</ul>
<p><span class="math display">r_{xy} = \frac{cov(x,y)}{SD_x \times
SD_y}</span></p>
<ul>
<li>
<strong>Spearman’s rank correlation</strong>: A non-parametric
measure of correlation, the Spearman correlation between two variables
is equal to the Pearson correlation between the rank scores of those two
variables; while Pearson’s correlation assesses linear relationships,
Spearman’s correlation assesses monotonic relationships (whether linear
or not). Confidence Intervals (CI) for Spearman’s correlations are
computed using the <span class="citation">Fieller, Hartley, and Pearson
(1957)</span> correction <span class="citation">(see Bishara and Hittner
2017)</span>.</li>
</ul>
<p><span class="math display">r_{s_{xy}} = \frac{cov(rank_x,
rank_y)}{SD(rank_x) \times SD(rank_y)}</span></p>
<ul>
<li>
<strong>Kendall’s rank correlation</strong>: In the normal case, the
Kendall correlation is preferred to the Spearman correlation because of
a smaller gross error sensitivity (GES) and a smaller asymptotic
variance (AV), making it more robust and more efficient. However, the
interpretation of Kendall’s tau is less direct compared to that of the
Spearman’s rho, in the sense that it quantifies the difference between
the % of concordant and discordant pairs among all possible pairwise
events. Confidence Intervals (CI) for Kendall’s correlations are
computed using the <span class="citation">Fieller, Hartley, and Pearson
(1957)</span> correction <span class="citation">(see Bishara and Hittner
2017)</span>. For each pair of observations (i ,j) of two variables (x,
y), it is defined as follows:</li>
</ul>
<p><span class="math display">\tau_{xy} =
\frac{2}{n(n-1)}\sum_{i&lt;j}^{}sign(x_i - x_j) \times sign(y_i -
y_j)</span></p>
<ul>
<li><p><strong>Biweight midcorrelation</strong>: A measure of similarity
that is median-based, instead of the traditional mean-based, thus being
less sensitive to outliers. It can be used as a robust alternative to
other similarity metrics, such as Pearson correlation <span class="citation">(Langfelder and Horvath 2012)</span>.</p></li>
<li><p><strong>Distance correlation</strong>: Distance correlation
measures both linear and non-linear association between two random
variables or random vectors (for more, see <span class="citation">Székely, Rizzo, and Bakirov (2007)</span>, <span class="citation">Székely and Rizzo (2009)</span>). This is in contrast
to Pearson’s correlation, which can only detect linear association
between two random variables.</p></li>
<li><p><strong>Percentage bend correlation</strong>: Introduced by
Wilcox (1994), it is based on a down-weight of a specified percentage of
marginal observations deviating from the median (by default, 20
percent).</p></li>
<li><p><strong>Shepherd’s Pi correlation</strong>: Equivalent to a
Spearman’s rank correlation after outliers removal (by means of
bootstrapped Mahalanobis distance).</p></li>
<li><p><strong>Blomqvist’s coefficient</strong>: The Blomqvist’s
coefficient (also referred to as Blomqvist’s Beta or medial correlation;
Blomqvist, 1950) is a median-based non-parametric correlation that has
some advantages over measures such as Spearman’s or Kendall’s estimates
(see Shmid and Schimdt, 2006).</p></li>
<li><p><strong>Hoeffding’s D</strong>: The Hoeffding’s D statistic is a
non-parametric rank based measure of association that detects more
general departures from independence (Hoeffding 1948), including
non-linear associations. Hoeffding’s D varies between -0.5 and 1 (if
there are no tied ranks, otherwise it can have lower values), with
larger values indicating a stronger relationship between the
variables.</p></li>
<li><p><strong>Gamma correlation</strong>: The Goodman-Kruskal gamma
statistic is similar to Kendall’s Tau coefficient. It is relatively
robust to outliers and deals well with data that have many
ties.</p></li>
<li><p><strong>Gaussian rank correlation</strong>: The Gaussian rank
correlation estimator is a simple and well-performing alternative for
robust rank correlations (Boudt et al., 2012). It is based on the
Gaussian quantiles of the ranks.</p></li>
<li><p><strong>Point-Biserial and biserial correlation</strong>:
Correlation coefficient used when one variable is continuous and the
other is dichotomous (binary). Point-Biserial is equivalent to a
Pearson’s correlation, while Biserial should be used when the binary
variable is assumed to have an underlying continuity. For example,
anxiety level can be measured on a continuous scale, but can be
classified dichotomously as high/low.</p></li>
<li><p><strong>Winsorized correlation</strong>: Correlation of variables
that have been Winsorized, i.e., transformed by limiting extreme values
to reduce the effect of possibly spurious outliers.</p></li>
<li><p><strong>Polychoric correlation</strong>: Correlation between two
theorised normally distributed continuous latent variables, from two
observed ordinal variables.</p></li>
<li><p><strong>Tetrachoric correlation</strong>: Special case of the
polychoric correlation applicable when both observed variables are
dichotomous.</p></li>
<li><p><strong>Partial correlation</strong>: Correlation between two
variables after adjusting for the (linear) effect of one or more
variables. The correlation test is run after having partialized the
dataset, independently from it. In other words, it considers
partialization as an independent step generating a different dataset,
rather than belonging to the same model. This is why some discrepancies
are to be expected for the <em>t</em>- and the <em>p</em>-values (but
not the correlation coefficient) compared to other implementations such
as <code>ppcor</code>. Let <span class="math inline">e_{x.z}</span> be
the residuals from the linear prediction of <span class="math inline">x</span> by <span class="math inline">z</span> (note
that this can be expanded to a multivariate <span class="math inline">z</span>):</p></li>
</ul>
<p><span class="math display">r_{xy.z} = r_{e_{x.z},e_{y.z}}</span></p>
<ul>
<li>
<strong>Multilevel correlation</strong>: Multilevel correlations are
a special case of partial correlations where the variable to be adjusted
for is a factor and is included as a random effect in a mixed-effects
model.</li>
</ul>
</div>
<div class="section level3">
<h3 id="comparison">Comparison<a class="anchor" aria-label="anchor" href="#comparison"></a>
</h3>
<p>We will fit different types of correlations of generated data with
different link strengths and link types.</p>
<p>Let’s first load the required libraries for this analysis.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/correlation/">correlation</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/bayestestR/" class="external-link">bayestestR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/see/" class="external-link">see</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/datawizard/" class="external-link">datawizard</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nathaneastwood.github.io/poorman/" class="external-link">poorman</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="utility-functions">Utility functions<a class="anchor" aria-label="anchor" href="#utility-functions"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">generate_results</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">r</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">100</span>, <span class="va">transformation</span> <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">bayestestR</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/simulate_correlation.html" class="external-link">simulate_correlation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">transformation</span> <span class="op">!=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"("</span>, <span class="va">transformation</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">"data$V2)"</span>, <span class="st">"data$V2"</span><span class="op">)</span></span>
<span>    <span class="va">transformation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">transformation</span>, <span class="va">var</span><span class="op">)</span></span>
<span>    <span class="va">data</span><span class="op">$</span><span class="va">V2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="va">transformation</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, transformation <span class="op">=</span> <span class="va">transformation</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">out</span><span class="op">$</span><span class="va">Pearson</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_test.html">cor_test</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"V1"</span>, <span class="st">"V2"</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span><span class="op">$</span><span class="va">r</span></span>
<span>  <span class="va">out</span><span class="op">$</span><span class="va">Spearman</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_test.html">cor_test</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"V1"</span>, <span class="st">"V2"</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span><span class="op">$</span><span class="va">rho</span></span>
<span>  <span class="va">out</span><span class="op">$</span><span class="va">Kendall</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_test.html">cor_test</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"V1"</span>, <span class="st">"V2"</span>, method <span class="op">=</span> <span class="st">"kendall"</span><span class="op">)</span><span class="op">$</span><span class="va">tau</span></span>
<span>  <span class="va">out</span><span class="op">$</span><span class="va">Biweight</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_test.html">cor_test</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"V1"</span>, <span class="st">"V2"</span>, method <span class="op">=</span> <span class="st">"biweight"</span><span class="op">)</span><span class="op">$</span><span class="va">r</span></span>
<span>  <span class="va">out</span><span class="op">$</span><span class="va">Distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_test.html">cor_test</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"V1"</span>, <span class="st">"V2"</span>, method <span class="op">=</span> <span class="st">"distance"</span><span class="op">)</span><span class="op">$</span><span class="va">r</span></span>
<span>  <span class="va">out</span><span class="op">$</span><span class="va">Distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_test.html">cor_test</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"V1"</span>, <span class="st">"V2"</span>, method <span class="op">=</span> <span class="st">"distance"</span><span class="op">)</span><span class="op">$</span><span class="va">r</span></span>
<span></span>
<span>  <span class="va">out</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="effect-of-relationship-type">Effect of Relationship Type<a class="anchor" aria-label="anchor" href="#effect-of-relationship-type"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.999</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">transformation</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"none"</span>,</span>
<span>      <span class="st">"exp("</span>,</span>
<span>      <span class="st">"log10(1+max(abs(data$V2))+"</span>,</span>
<span>      <span class="st">"1/"</span>,</span>
<span>      <span class="st">"tan("</span>,</span>
<span>      <span class="st">"sin("</span>,</span>
<span>      <span class="st">"cos("</span>,</span>
<span>      <span class="st">"cos(2*"</span>,</span>
<span>      <span class="st">"abs("</span>,</span>
<span>      <span class="st">"data$V2*"</span>,</span>
<span>      <span class="st">"data$V2*data$V2*"</span>,</span>
<span>      <span class="st">"ifelse(data$V2&gt;0, 1, 0)*("</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu">generate_results</span><span class="op">(</span><span class="va">r</span>, <span class="va">n</span>, transformation <span class="op">=</span> <span class="va">transformation</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">data</span> <span class="op"><a href="https://nathaneastwood.github.io/poorman/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">datawizard</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/datawizard/reference/data_to_long.html" class="external-link">reshape_longer</a></span><span class="op">(</span></span>
<span>    select <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"r"</span>, <span class="st">"transformation"</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"Type"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"Estimation"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://nathaneastwood.github.io/poorman/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://nathaneastwood.github.io/poorman/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html" class="external-link">relevel</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Type</span><span class="op">)</span>, <span class="st">"Pearson"</span>, <span class="st">"Spearman"</span>, <span class="st">"Kendall"</span>, <span class="st">"Biweight"</span>, <span class="st">"Distance"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://nathaneastwood.github.io/poorman/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">r</span>, y <span class="op">=</span> <span class="va">Estimation</span>, fill <span class="op">=</span> <span class="va">Type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Type</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"loess"</span>, alpha <span class="op">=</span> <span class="fl">0</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">see</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/see/reference/theme_modern.html" class="external-link">theme_modern</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/see/reference/scale_color_flat.html" class="external-link">scale_color_flat_d</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"rainbow"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/see/reference/scale_color_flat.html" class="external-link">scale_fill_flat_d</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"rainbow"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">transformation</span><span class="op">)</span></span></code></pre></div>
<p><img src="types_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://nathaneastwood.github.io/poorman/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">datawizard</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/datawizard/reference/data_to_long.html" class="external-link">reshape_longer</a></span><span class="op">(</span></span>
<span>    select <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"r"</span>, <span class="st">"transformation"</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"Type"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"Estimation"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://nathaneastwood.github.io/poorman/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">r</span> <span class="op">~</span> <span class="va">Type</span> <span class="op">/</span> <span class="va">Estimation</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://nathaneastwood.github.io/poorman/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">parameters</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">parameters</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://nathaneastwood.github.io/poorman/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">model</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>, <span class="fu"><a href="https://nathaneastwood.github.io/poorman/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">Coefficient</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Parameter                    | Coefficient |   SE |       95% CI | t(11903) |      p
&gt; ------------------------------------------------------------------------------------
&gt; Type [Distance] × Estimation |        0.90 | 0.02 | [0.86, 0.95] |    40.14 | &lt; .001
&gt; Type [Kendall] × Estimation  |        0.66 | 0.02 | [0.62, 0.70] |    32.07 | &lt; .001
&gt; Type [Biweight] × Estimation |        0.53 | 0.02 | [0.50, 0.57] |    29.24 | &lt; .001
&gt; Type [Spearman] × Estimation |        0.51 | 0.02 | [0.48, 0.54] |    31.70 | &lt; .001
&gt; Type [Pearson] × Estimation  |        0.44 | 0.02 | [0.41, 0.47] |    26.49 | &lt; .001</code></pre>
<p>As we can see, <strong>distance</strong> correlation is able to
capture the strength even for severely non-linear relationships.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-bishara2017confidence" class="csl-entry">
Bishara, Anthony J, and James B Hittner. 2017. <span>“Confidence
Intervals for Correlations When Data Are Not Normal.”</span>
<em>Behavior Research Methods</em> 49 (1): 294–309. <a href="https://doi.org/10.3758/s13428-016-0702-8" class="external-link">https://doi.org/10.3758/s13428-016-0702-8</a>.
</div>
<div id="ref-fieller1957tests" class="csl-entry">
Fieller, Edgar C, Herman O Hartley, and Egon S Pearson. 1957.
<span>“Tests for Rank Correlation Coefficients. i.”</span>
<em>Biometrika</em> 44 (3/4): 470–81. <a href="https://doi.org/10.1093/biomet/48.1-2.29" class="external-link">https://doi.org/10.1093/biomet/48.1-2.29</a>.
</div>
<div id="ref-langfelder2012fast" class="csl-entry">
Langfelder, Peter, and Steve Horvath. 2012. <span>“Fast r Functions for
Robust Correlations and Hierarchical Clustering.”</span> <em>Journal of
Statistical Software</em> 46 (11). <a href="https://www.jstatsoft.org/v46/i11/" class="external-link">https://www.jstatsoft.org/v46/i11/</a>.
</div>
<div id="ref-Rteam" class="csl-entry">
R Core Team. 2019. <em>R: A Language and Environment for Statistical
Computing</em>. Vienna, Austria: R Foundation for Statistical Computing.
<a href="https://www.R-project.org/" class="external-link">https://www.R-project.org/</a>.
</div>
<div id="ref-szekely2009brownian" class="csl-entry">
Székely, Gábor J, and Maria L Rizzo. 2009. <span>“Brownian Distance
Covariance.”</span> <em>The Annals of Applied Statistics</em> 3 (4):
1236–65.
</div>
<div id="ref-szekely2007measuring" class="csl-entry">
Székely, Gábor J, Maria L Rizzo, and Nail K Bakirov. 2007.
<span>“Measuring and Testing Dependence by Correlation of
Distances.”</span> <em>The Annals of Statistics</em> 35 (6): 2769–94.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique Makowski</a>, <a href="https://wiernik.org/" class="external-link">Brenton M. Wiernik</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>, <a href="https://home.msbstats.info/" class="external-link">Mattan S. Ben-Shachar</a>, <a href="https://remi-theriault.com/" class="external-link">Rémi Thériault</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
